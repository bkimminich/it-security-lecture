# Sasser

_Malware profile by **Timo Dohl** and **Mattes WitthÃ¶ft**_

### Classification

| Virus | Worm               | Trojan | Ransomware | Botnet | Other |
| :---- | :----------------- | :----- | :--------- | :----- | :---- |
|       | :heavy_check_mark: |        |            |        |       |

### Facts & Figures

- **Year:** 2004 [^1] [^2]
- **Author:** Sven Jaschan [^1] [^2]
- **Language:** C++ [^1]
- **Infections:** near 10 million PCs [^3]
- **Damage:** $18.1 billion [^1]

### Description

> When a vulnerable system is found, the worm sends shell code to the target computer that attempts to exploit the lsass.exe buffer overflow vulnerability. The lsass.exe process may crash after being exploited, and Windows will display an alert and attempt to shut the system down. A remote shell opens on Port 9996.
>
> It creates and executes a script file on the target named cmd.ftp, which causes the target computer to download Sasser from a worm-created FTP server on the infecting computer. The worm will be saved to the System folder. The downloaded file will have a file name of four or five random numbers, followed by \_up.exe.
>
> Upon execution, Sasser attempts to create a mutex named Jobaka3l, which it uses to check if there is a Sasser worm already running on the system. It stops further infection if it finds one. Sasser copies itself to the Windows folder as avserve.exe. It adds the value "avserve.exe = (Windows folder)\avserve.exe" the registry key that will cause the worm to run when the system restarts. Attempts to shut down the computer may be hindered anyway, as the worm uses the AbortSystemShutdown API.
>
> Sasser creates an FTP server on Port 5554, which it will use to spread itself. Ir creates a file at the root of the C: drive named win.log, which contains the IP address of the computer that the worm most recently attempted to infect, as well as the number of infected computers. The worm uses gethostbyname, a Windows API, to check the system's IP address, so it can generate an IP address based on this one. 25% of the time, the first two numbers of the IP address it generates will be the same as the current host, while the last two are random. There is a 23% chance that number will be the same and a 52% chance that the generated IP address will be completely random.
>
> The worm makes a connection to a generated IP address on Port 445 in order to determine if there is a computer at that address. When it finds one, it sends shellcode to that computer that exploits the lsass.exe buffer overflow vulnerability, opening a remote shell on Port 9996.
>
> It creates a script on the target system named cmd.ftp, which instructs the system to download the worm from the infecting system's FTP server. After the worm has been downloaded to the target system, cmd.ftp may be deleted.
>
> [^1]

```
[^1]: https://malwiki.org/index.php?title=Sasser
[^2]: https://en.wikipedia.org/wiki/Sasser_(computer_worm)
[^2]: https://www.computerwissen.de/sicherheit/malware/5-bekannte-computerviren/
```
