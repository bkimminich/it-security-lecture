# Nimda

_Malware profile by **Julius KÃ¼hne** and **Laurin Kuhn**_

### Classification


| Virus              | Worm               | Trojan             | Ransomware         | Botnet             | Other                                   |
|:-------------------|:-------------------|:-------------------|:-------------------|:-------------------|:----------------------------------------|
|                    | :heavy_check_mark: |                    |                    |                    |                                         |

### Facts & Figures

* **Year:** _: 2001 [^1]
* **Author:** _: Multiple unknown Authors, Origin: China [^1]
* **Language:** _: C++ [^2]
* **Infections:** _: 160.000 [^2]
* **Damage:** _: $2.6 billion [^2]

### Description

[...]

The Nimda worm has different methods of transferring itself to different computers and networks. It also has the ability to infect files.

Nimda can arrive on a computer from visiting an infected website. An infected website will contain the following JavaScript code that causes the browser to download the README.EML file containing the worm.
The README.EML file will open in a minimimized window if the user uses Explorer 5.5 with Service Pack 1 or earlier. It may not be able to infect Windows NT and 2000 in this way.

The worm may also come from an email attachment named README.EXE. The subject and message body are usually empty, though the subject may sometimes be random. The message has two sections, one has the MIME type text/html, which is blank, and the other has the type audio/x-wav. The audio/x-wav section is actually a binary executable, the README.EXE attachment. It may be able to run itself from the preview pane with no intervention from the user, as the worm exploits a vulnerability that exists in Explorer 5.5 with Service Pack 1 or earlier when Explorer is used to render html mail.

If the user's computer is on a local network where another computer has been infected with the worm, it will arrive as RICHED20.DLL in any folder with a .doc or .eml file. These files will be hidden.

The worm may also be transmitted from one computer to one running a Microsoft IIS 4.0 / 5.0 server either by a exploiting a directory traversal vulnerability in the server or by using backdoors left by CodeRed.II. It arrives a TFTP#### and is be copied to the server's "scripts" directory as "ADMIN.DLL".

[...]

[^2]

The actual lifecycle of Nimda can be split to four parts:

1) File infection: Nimda locates EXE files from a local machine and infects them by putting the file inside its body as a resource, thus 'assimilating' that file.These files then spread the infection when people exchange programs such as games.

2) Mass mailer: Nimda locates email addresses via MAPI from your email client as well as searching local HTML files for additional addresses. Then it sends one email to each address. These mails contain an attachment called README.EXE, which might be executed automatically on some systems.

3) Web worm: Nimda starts to scan the internet, trying to locate www servers. Once a web server is found, the worm tries to infect it by using several known security holes. If this succeeds, the worm will modify random web pages on the site. End result of this modification is that web surfers browsing the site will get automatically infected by the worm.

4) LAN propagation: Nimda will search for file shares in the local network, either from file servers or from end user machines. Once it finds any, it will drop a hidden file called "RICHED20.DLL" to any directory which has DOC and EML files. When any other user tries to open DOC or EML files from these directories, Word, Wordpad or Outlook will execute RICHED20.DLL causing an infection of the PC. The worm will also infect remote files if it was started on a server.

[...]

[^1]

[^1]: https://www.f-secure.com/v-descs/nimda.shtml
[^2]: http://virus.wikidot.com/nimda
